# BDT Pipeline for sPHENIX Analysis

This document describes the steps to run the Boosted Decision Tree (BDT) pipeline for sPHENIX analysis. The pipeline consists of generating input files from ROOT files, and then training and evaluating the BDT model.

## Prerequisites

The `BDTinput.C` script requires the `yaml-cpp` library to parse configuration files. You need to install it first.

### Installing `yaml-cpp`

You can install `yaml-cpp` from source:

```bash
git clone https://github.com/jbeder/yaml-cpp.git
cd yaml-cpp
mkdir build
cd build
cmake .. -DCMAKE_INSTALL_PREFIX=/path/to/your/install/dir
make
make install
```

After installation, you need to update the path to the `libyaml-cpp.so` file in `BDTinput.C`. Open `BDTinput.C` and modify this line with the correct path:

```cpp
gSystem->Load("/path/to/your/install/dir/lib64/libyaml-cpp.so");
```

## Step 1: Generate Input Files

The input files for the BDT training are generated by running the `BDTinput.C` ROOT macro.

### Usage

Launch ROOT and run the script:

```sh
root -l
.L BDTinput.C
BDTinput("config_nom.yaml", "jet10")
```

The `BDTinput` function takes two arguments:
1.  `configname`: The YAML configuration file (e.g., `config_nom.yaml`).
2.  `filetype`: The type of dataset to process (e.g., `jet10`, `photon5`, `data`).

This will generate a `.root` file containing the trees for BDT training.

## Step 2: Train and Evaluate the BDT

The training and evaluation of the BDT model is done using the `binned_training.ipynb` Jupyter notebook.

### Usage

1.  **Launch Jupyter Notebook**:
    ```bash
    jupyter notebook binned_training.ipynb
    ```

2.  **Configure the notebook**:
    -   Open the notebook.
    -   In the first few cells, you will find variables to set the input file path, and other parameters for training.
    -   Set the `input_file` variable to the path of the `.root` file generated in Step 1.

3.  **Run the notebook**:
    -   Execute the cells in the notebook sequentially.
    -   The notebook will:
        -   Load the data.
        -   Train the XGBoost model in bins of pT.
        -   Evaluate the model and generate performance plots like ROC curves.
        -   Save the trained models.
